<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="613px" preserveAspectRatio="none" style="width:596px;height:613px;" version="1.1" viewBox="0 0 596 613" width="596px" zoomAndPan="magnify"><defs><filter height="300%" id="fz7842w3qribd" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="58" x2="58" y1="86.2969" y2="526.1563"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="267.5" x2="267.5" y1="86.2969" y2="526.1563"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="516.5" x2="516.5" y1="86.2969" y2="526.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="26" y="82.9951">Inbound</text><ellipse cx="58" cy="13" fill="#FEFECE" filter="url(#fz7842w3qribd)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M58,21 L58,48 M45,29 L71,29 M58,48 L45,63 M58,48 L71,63 " fill="#FEFECE" filter="url(#fz7842w3qribd)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="26" y="538.1514">Inbound</text><ellipse cx="58" cy="551.4531" fill="#FEFECE" filter="url(#fz7842w3qribd)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M58,559.4531 L58,586.4531 M45,567.4531 L71,567.4531 M58,586.4531 L45,601.4531 M58,586.4531 L71,601.4531 " fill="#FEFECE" filter="url(#fz7842w3qribd)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fz7842w3qribd)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="61" x="235.5" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="243" y="54.6982">Traffic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="242.5" y="70.9951">Server</text><rect fill="#FEFECE" filter="url(#fz7842w3qribd)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="61" x="235.5" y="525.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="243" y="545.1514">Traffic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="242.5" y="561.4482">Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141" x="443.5" y="82.9951">app-server-56:4443</text><ellipse cx="517" cy="54" fill="#FEFECE" filter="url(#fz7842w3qribd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="505" x2="529" y1="68" y2="68"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141" x="443.5" y="538.1514">app-server-56:4443</text><ellipse cx="517" cy="557.4531" fill="#FEFECE" filter="url(#fz7842w3qribd)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="505" x2="529" y1="571.4531" y2="571.4531"/><polygon fill="#008000" points="69,113.2969,59,117.2969,69,121.2969,65,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="256,113.2969,266,117.2969,256,121.2969,260,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="63" x2="262" y1="117.2969" y2="117.2969"/><text fill="#008000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="75" y="112.3638">TCP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="104" y="112.3638">Handshake</text><polygon fill="#0000FF" points="256,157.4297,266,161.4297,256,165.4297,260,161.4297" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="58" x2="262" y1="161.4297" y2="161.4297"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="23" x="65" y="141.4966">TLS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="92" y="141.4966">Client HELLO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="65" y="156.6294">SNI=service-2.example.com</text><polygon fill="#FBFB77" filter="url(#fz7842w3qribd)" points="194,174.6953,194,214.6953,338,214.6953,338,184.6953,328,174.6953,194,174.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="328" x2="328" y1="174.6953" y2="184.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338" x2="328" y1="184.6953" y2="184.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="200" y="191.7622">Examine SNI value</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="200" y="206.895">Select Outbound</text><polygon fill="#008000" points="279,240.9609,269,244.9609,279,248.9609,275,244.9609" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="505,240.9609,515,244.9609,505,248.9609,509,244.9609" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="273" x2="511" y1="244.9609" y2="244.9609"/><text fill="#008000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="285" y="240.0278">TCP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="314" y="240.0278">Handshake</text><polygon fill="#A80036" points="505,270.0938,515,274.0938,505,278.0938,509,274.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="268" x2="511" y1="274.0938" y2="274.0938"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="34" x="275" y="269.1606">HTTP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="313" y="269.1606"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="313" y="269.1606">CONNECT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="373" y="269.1606">app-server-56:4443</text><polygon fill="#A80036" points="279,299.2266,269,303.2266,279,307.2266,275,303.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="273" x2="516" y1="303.2266" y2="303.2266"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="285" y="298.2935">200Â OK</text><polygon fill="#0000FF" points="505,343.3594,515,347.3594,505,351.3594,509,347.3594" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="268" x2="511" y1="347.3594" y2="347.3594"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="23" x="275" y="327.4263">TLS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="302" y="327.4263">Client HELLO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="275" y="342.5591">SNI=service-2.example.com</text><polygon fill="#FBFB77" filter="url(#fz7842w3qribd)" points="57,318.9258,57,343.9258,259,343.9258,259,328.9258,249,318.9258,57,318.9258" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="249" x2="249" y1="318.9258" y2="328.9258"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="259" x2="249" y1="328.9258" y2="328.9258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="63" y="335.9927">Duplicate of Inbound HELLO</text><polygon fill="#FBFB77" filter="url(#fz7842w3qribd)" points="181,360.625,181,400.625,350,400.625,350,370.625,340,360.625,181,360.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="340" y1="360.625" y2="370.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="340" y1="370.625" y2="370.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="187" y="377.6919">Forward bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="187" y="392.8247">Inbound</text><path d="M247.25,385.0573 L244,388.3409 L247.25,391.5573 L247.25,389.3906 L252.6667,389.3906 L252.6667,387.224 L247.25,387.224 L247.25,385.0573 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="257.6667" y="392.8247"/><path d="M264.0833,385.0573 L264.0833,387.224 L258.6667,387.224 L258.6667,389.3906 L264.0833,389.3906 L264.0833,391.5573 L267.3333,388.2737 L264.0833,385.0573 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="272.3333" y="392.8247">Outbound</text><polygon fill="#FBFB77" filter="url(#fz7842w3qribd)" points="8,414.8906,8,439.8906,567,439.8906,567,424.8906,557,414.8906,8,414.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="557" x2="557" y1="414.8906" y2="424.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="567" x2="557" y1="424.8906" y2="424.8906"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="230.75" y="431.9575">TLS negotiation</text><polygon fill="#0000FF" points="69,451.0234,59,455.0234,69,459.0234,65,455.0234" style="stroke: #0000FF; stroke-width: 1.0;"/><polygon fill="#0000FF" points="505,451.0234,515,455.0234,505,459.0234,509,455.0234" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="63" x2="511" y1="455.0234" y2="455.0234"/><polygon fill="#FBFB77" filter="url(#fz7842w3qribd)" points="8,468.0234,8,493.0234,567,493.0234,567,478.0234,557,468.0234,8,468.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="557" x2="557" y1="468.0234" y2="478.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="567" x2="557" y1="478.0234" y2="478.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="239.75" y="485.0903">Transactions</text><polygon fill="#000000" points="69,504.1563,59,508.1563,69,512.1563,65,508.1563" style="stroke: #000000; stroke-width: 1.0;"/><polygon fill="#000000" points="505,504.1563,515,508.1563,505,512.1563,509,508.1563" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="63" x2="511" y1="508.1563" y2="508.1563"/><!--
@startuml

actor Inbound
participant "Traffic\nServer" as TS
entity "app-server-56:4443" as Outbound

Inbound <-[#green]> TS : <font color="green">//TCP//</font> Handshake
Inbound -[#blue]> TS : <font color="blue">//TLS//</font> Client HELLO\nSNI=service-2.example.com
note over TS : Examine SNI value\nSelect Outbound
TS <-[#green]> Outbound : <font color="green">//TCP//</font> Handshake
TS -> Outbound : <font color="red">//HTTP//</font> ""CONNECT"" app-server-56:4443
Outbound -> TS : ""200 OK""
TS -[#blue]> Outbound : <font color="blue">//TLS//</font> Client HELLO\nSNI=service-2.example.com
note left : Duplicate of Inbound HELLO
note over TS : Forward bytes\nInbound <&arrow-thick-left> <&arrow-thick-right> Outbound
note over Inbound, Outbound : <font color="blue">TLS negotiation</font>
Inbound <-[#blue]-> Outbound
note over Inbound, Outbound : Transactions
Inbound <-[#black]-> Outbound

@enduml

PlantUML version 1.2017.18(Fri Oct 06 11:56:32 CDT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_151-b12
Operating System: Linux
OS Version: 4.13.13-200.fc26.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>