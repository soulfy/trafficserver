<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="496px" preserveAspectRatio="none" style="width:428px;height:496px;" version="1.1" viewBox="0 0 428 496" width="428px" zoomAndPan="magnify"><defs><filter height="300%" id="fsmtqap5irkzc" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="119" x2="119" y1="86.2969" y2="409.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="244.5" x2="244.5" y1="86.2969" y2="409.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="371" x2="371" y1="86.2969" y2="409.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="87" y="82.9951">Inbound</text><ellipse cx="119" cy="13" fill="#FEFECE" filter="url(#fsmtqap5irkzc)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M119,21 L119,48 M106,29 L132,29 M119,48 L106,63 M119,48 L132,63 " fill="#FEFECE" filter="url(#fsmtqap5irkzc)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="87" y="421.6201">Inbound</text><ellipse cx="119" cy="434.9219" fill="#FEFECE" filter="url(#fsmtqap5irkzc)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M119,442.9219 L119,469.9219 M106,450.9219 L132,450.9219 M119,469.9219 L106,484.9219 M119,469.9219 L132,484.9219 " fill="#FEFECE" filter="url(#fsmtqap5irkzc)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fsmtqap5irkzc)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="61" x="212.5" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="220" y="54.6982">Traffic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="219.5" y="70.9951">Server</text><rect fill="#FEFECE" filter="url(#fsmtqap5irkzc)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="61" x="212.5" y="408.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="220" y="428.6201">Traffic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="219.5" y="444.917">Server</text><rect fill="#FEFECE" filter="url(#fsmtqap5irkzc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="327" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="334" y="70.9951">Outbound</text><rect fill="#FEFECE" filter="url(#fsmtqap5irkzc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="327" y="408.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="334" y="428.6201">Outbound</text><polygon fill="#008000" points="130,113.2969,120,117.2969,130,121.2969,126,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="233,113.2969,243,117.2969,233,121.2969,237,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="124" x2="239" y1="117.2969" y2="117.2969"/><text fill="#008000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="136" y="112.3638">TCP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="165" y="112.3638">Handshake</text><polygon fill="#0000FF" points="233,142.4297,243,146.4297,233,150.4297,237,146.4297" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="119" x2="239" y1="146.4297" y2="146.4297"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="70" x="126" y="141.4966">initial data</text><polygon fill="#FBFB77" filter="url(#fsmtqap5irkzc)" points="167,159.5625,167,199.5625,319,199.5625,319,169.5625,309,159.5625,167,159.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="309" x2="309" y1="159.5625" y2="169.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="319" x2="309" y1="169.5625" y2="169.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="173" y="176.6294">Examine initial data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="173" y="191.7622">select Outbound</text><polygon fill="#008000" points="256,225.8281,246,229.8281,256,233.8281,252,229.8281" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="359,225.8281,369,229.8281,359,233.8281,363,229.8281" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="250" x2="365" y1="229.8281" y2="229.8281"/><text fill="#008000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="262" y="224.895">TCP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="291" y="224.895">Handshake</text><polygon fill="#FBFB77" filter="url(#fsmtqap5irkzc)" points="209,242.9609,209,282.9609,406,282.9609,406,252.9609,396,242.9609,209,242.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="396" x2="396" y1="242.9609" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="406" x2="396" y1="252.9609" y2="252.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="247.75" y="260.0278">Additional Setup</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="247.75" y="275.1606">(in some cases)</text><polygon fill="#0000FF" points="359,314.2266,369,318.2266,359,322.2266,363,318.2266" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="245" x2="365" y1="318.2266" y2="318.2266"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="70" x="252" y="313.2935">initial data</text><polygon fill="#FBFB77" filter="url(#fsmtqap5irkzc)" points="8,297.2266,8,322.2266,236,322.2266,236,307.2266,226,297.2266,8,297.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="226" x2="226" y1="297.2266" y2="307.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236" x2="226" y1="307.2266" y2="307.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="14" y="314.2935">Duplicate of data from Inbound.</text><polygon fill="#FBFB77" filter="url(#fsmtqap5irkzc)" points="158,336.3594,158,376.3594,327,376.3594,327,346.3594,317,336.3594,158,336.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="317" x2="317" y1="336.3594" y2="346.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327" x2="317" y1="346.3594" y2="346.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="164" y="353.4263">Forward bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="164" y="368.5591">Inbound</text><path d="M224.25,360.7917 L221,364.0753 L224.25,367.2917 L224.25,365.125 L229.6667,365.125 L229.6667,362.9583 L224.25,362.9583 L224.25,360.7917 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="234.6667" y="368.5591"/><path d="M241.0833,360.7917 L241.0833,362.9583 L235.6667,362.9583 L235.6667,365.125 L241.0833,365.125 L241.0833,367.2917 L244.3333,364.0081 L241.0833,360.7917 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="249.3333" y="368.5591">Outbound</text><polygon fill="#A80036" points="130,387.625,120,391.625,130,395.625,126,391.625" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="359,387.625,369,391.625,359,395.625,363,391.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="124" x2="365" y1="391.625" y2="391.625"/><!--
@startuml

actor Inbound
participant "Traffic\nServer" as TS
participant Outbound

Inbound <-[#green]> TS : <font color="green">//TCP//</font> Handshake
Inbound -[#blue]> TS : <font color="blue">//initial data//</font>
note over TS : Examine initial data\nselect Outbound
TS <-[#green]> Outbound : <font color="green">//TCP//</font> Handshake
note over TS, Outbound : Additional Setup\n(in some cases)
TS -[#blue]> Outbound : <font color="blue">//initial data//</font>
note left : Duplicate of data from Inbound.
note over TS : Forward bytes\nInbound <&arrow-thick-left> <&arrow-thick-right> Outbound
Inbound <- -> Outbound

@enduml

PlantUML version 1.2017.18(Fri Oct 06 11:56:32 CDT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_151-b12
Operating System: Linux
OS Version: 4.13.13-200.fc26.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>